# é¡¹ç›®åç§°ï¼šå…¨å›½çœä¼šåŸå¸‚AQIç ”ç©¶


> # é¡¹ç›®è¯´æ˜è§†é¢‘ç½‘ç›˜é“¾æ¥ï¼šhttps://pan.baidu.com/s/1-ZU_9rU_hFOAO4Bh81GraA 
**æ³¨ï¼šè¯´æ˜è§†é¢‘ä¸­AQIå¯è§†åŒ–å¤§å±å±•ç¤ºçš„ç‰‡æ®µè‹¥æœ‰é—ªå±å¯çœ‹è¯¥mdæ–‡æ¡£ä¸‹çš„[åŠ¨å›¾æ¼”ç¤º](#ApacheCharts)**
> # æå–ç ï¼šHTGS

***

# é¡¹ç›®æ–‡ä»¶ç»“æ„

- ğŸ“ **[data](./data)(çˆ¬è™«ä¸æ•°æ®åˆ†æ)** 
  - ğŸ“ **[AllData](./data/AllData)ï¼ˆAQIæ•°æ®ï¼‰**
  - ğŸ“ **[dataAnalyse](./data/dataAnalyse)ï¼ˆæ•°æ®åˆ†æï¼‰**
  - ğŸ“ **[historyDataFetch](./data/historyDataFetch)ï¼ˆå†å²æ•°æ®çˆ¬è™«ä»£ç ï¼‰**
  - ğŸ“ **[realtimeDataFetch](./data/realtimeDataFetch)ï¼ˆå®æ—¶æ•°æ®çˆ¬è™«ä»£ç ï¼‰**
  
- ğŸ“ **[images](./images) (å›¾ç‰‡)**

- ğŸ“ **[predictModel](./predictModel) (é¢„æµ‹æ¨¡å‹)**

- ğŸ“ **[static](./static) (å¯è§†åŒ–å¤§å±é…ç½®)**

- ğŸ“ **[templates](./templates) (å¯è§†åŒ–å¤§å±html)**
  
- ğŸ“„ **[app.py](./app.py)ï¼ˆå¯è§†åŒ–å¤§å±è¿è¡Œç¨‹åºï¼‰**

- ğŸ“„ **README.md**

***

# ä¸€ã€é¡¹ç›®èƒŒæ™¯
***
+ ### **é¡¹ç›®åç§°:å…¨å›½çœä¼šåŸå¸‚AQIç ”ç©¶**
**æ³¨ï¼šæœ¬é¡¹ç›®æ‰€æŒ‡çš„çœä¼šåŸå¸‚ä¸º31ä¸ªçœä¼šåŸå¸‚ï¼Œä¸åŒ…æ‹¬é¦™æ¸¯ã€æ¾³é—¨ã€å°åŒ—(ç©ºæ°”è´¨é‡ç«™ç‚¹æ²¡æœ‰è¿™ä¸‰ä¸ªçœä¼šçš„å†å²æ•°æ®)**

+ ### **AQIç›¸å…³çŸ¥è¯†ï¼š**

> + **AQIï¼ˆAir Quality Indexï¼Œç©ºæ°”è´¨é‡æŒ‡æ•°ï¼‰æ˜¯ä¸€ç§ç”¨äºè¡¡é‡ç©ºæ°”è´¨é‡çš„ç»¼åˆæŒ‡æ•°ï¼Œå®ƒé€šå¸¸åŒ…æ‹¬ä¸€ç³»åˆ—ç©ºæ°”æ±¡æŸ“ç‰©çš„æµ“åº¦æ•°æ®ï¼Œä»¥æä¾›å¯¹ç©ºæ°”è´¨é‡çš„æ•´ä½“è¯„ä¼°ã€‚**

> + **AQIçš„ç­‰çº§ï¼š AQIé€šå¸¸åˆ†ä¸ºä¸åŒçš„ç­‰çº§ï¼Œæ¯ä¸ªç­‰çº§ä»£è¡¨ä¸€ç§ç©ºæ°”è´¨é‡çŠ¶å†µã€‚å¸¸è§çš„ç­‰çº§åŒ…æ‹¬â€œä¼˜â€ã€â€œè‰¯â€ã€â€œè½»åº¦æ±¡æŸ“â€ã€â€œä¸­åº¦æ±¡æŸ“â€ã€â€œé‡åº¦æ±¡æŸ“â€å’Œâ€œä¸¥é‡æ±¡æŸ“â€ã€‚è¿™äº›ç­‰çº§ä¸ä¸åŒçš„AQIå€¼èŒƒå›´ç›¸å¯¹åº”ã€‚**

> + **AQIçš„è®¡ç®—ï¼š AQIçš„è®¡ç®—é€šå¸¸æ¶‰åŠå¤šç§ç©ºæ°”æ±¡æŸ“ç‰©ï¼ŒåŒ…æ‹¬è‡­æ°§ï¼ˆO3ï¼‰ã€äºŒæ°§åŒ–ç¡«ï¼ˆSO2ï¼‰ã€æ°®æ°§åŒ–ç‰©ï¼ˆNO2ï¼‰ã€é¢—ç²’ç‰©ï¼ˆPM10å’ŒPM2.5ï¼‰ç­‰ã€‚æ¯ç§æ±¡æŸ“ç‰©éƒ½æœ‰ç›¸åº”çš„æµ“åº¦èŒƒå›´å’Œæƒé‡ï¼Œé€šè¿‡è®¡ç®—å¾—åˆ°ç»¼åˆçš„AQIå€¼ã€‚**

+ ### **é¡¹ç›®å¯è¡Œæ€§ï¼š**

>+ **æ•°æ®å¯è¡Œæ€§ï¼š AQIæ•°æ®é€šå¸¸æ¥è‡ªäºç©ºæ°”è´¨é‡ç›‘æµ‹ç«™ç‚¹ï¼Œè¿™äº›ç«™ç‚¹æµ‹é‡ä¸åŒå¤§æ°”æ±¡æŸ“ç‰©çš„æµ“åº¦ï¼Œå¦‚é¢—ç²’ç‰©ï¼ˆPM2.5ã€PM10ï¼‰ã€è‡­æ°§ï¼ˆO3ï¼‰ã€äºŒæ°§åŒ–ç¡«ï¼ˆSO2ï¼‰ã€ä¸€æ°§åŒ–ç¢³ï¼ˆCOï¼‰ç­‰ã€‚å› æ­¤å¯ä»¥é€šè¿‡çˆ¬è™«çˆ¬å–å„ä¸ªç©ºæ°”è´¨é‡ç›‘æµ‹ç«™ç‚¹ä¿å­˜çš„å†å²æ•°æ®æ¥è·å–ç›¸åº”çš„ç›®æ ‡æ•°æ®ã€‚è¿™äº›æ•°æ®çš„çœŸå®æ€§ä¹Ÿæœ‰æ‰€ä¿éšœã€‚**

>+ **æŠ€æœ¯å¯è¡Œæ€§ï¼šåŸºäºApache EChartsèƒ½è¾¾åˆ°è¾ƒå¥½çš„æ•°æ®å¯è§†åŒ–æ•ˆæœï¼ŒåŸºäºä¸åŒçš„æœºå™¨å­¦ä¹ æ¨¡å‹(å¦‚MLRã€RFã€SVR)å¯¹AQIçš„æ—¶åºé¢„æµ‹æ˜¯å¯è¡Œçš„ã€‚**

>+ **ä»·å€¼å¯è¡Œæ€§ï¼šAQIæ•°æ®çš„å¯è§†åŒ–ä¸é¢„æµ‹ä¸ä»…æœ‰åŠ©äºæé«˜å…¬ä¼—å¥åº·æ„è¯†ï¼Œè¿˜åœ¨ç¯å¢ƒç®¡ç†ã€ç§‘å­¦ç ”ç©¶ã€åº”æ€¥å“åº”å’Œç¤¾ä¼šå‚ä¸ç­‰æ–¹é¢å‘æŒ¥ç€é‡è¦çš„ä½œç”¨ã€‚**

***
### é¡¹ç›®å¯è§†åŒ–å¤§å±å±•ç¤ºï¼š
**æ³¨ï¼šå…·ä½“å›¾è¡¨çš„ç»†èŠ‚è§ä¸‹æ–¹[Apache EChartsæ•°æ®å¯è§†åŒ–éƒ¨åˆ†](#ApacheCharts)**
***
![](images/å¤§å±é™æ€.png)
***

# äºŒã€æ•°æ®è·å–

******

## (1ï¼‰AQIå†å²æ•°æ®è·å–ï¼ˆå„çœä¼šåŸå¸‚è¿‘åå¹´æ•°æ®ï¼‰

 
###  â‘   æ•°æ®çˆ¬å–è¿‡ç¨‹ï¼š
 
>**ä»AQIå†å²æ•°æ®æŸ¥è¯¢ç½‘ç«™(https://www.aqistudy.cn/historydata/)çˆ¬è™«è·å¾—**
![](./images/3.png)
***æ³¨ï¼šä¸Šè¿°å›¾ç‰‡æ¥è‡ªhttps://www.aqistudy.cn/historydata/daydata.php?city=%E4%B8%8A%E6%B5%B7&month=201707***

******

*åˆ†æç½‘é¡µï¼Œé‡‡å–requestsçˆ¬è™«:*

**ç›´æ¥è¿›è¡Œrequestçˆ¬è™«çˆ¬å–ç»“æœï¼š**

>![](./images/1.png)

**å—é™ç½‘ç«™åçˆ¬æœºåˆ¶ï¼Œçˆ¬å‡ºç»“æœä¸ºç©ºã€‚åˆ†æåŸå› ï¼Œæ”¹è¿›çˆ¬è™«ä»£ç ï¼š**

**-ç½‘é¡µåçˆ¬é™åˆ¶-ï¼š**

+ **åè°ƒè¯•ï¼šæ— é™debugger + ç¦ç”¨F12 + ç¦ç”¨ctrl+shift+c + ç¦ç”¨å³é”® ......**

>![](./images/7.png)
>![](./images/5.png)
>![](./images/4.png)
>![](./images/6.png)

+ **JSåŠ¨æ€è¿”å›ï¼Œæ•°æ®æ˜¯åŠ¨æ€åŠ è½½çš„æ— æ³•ä¹‹å‰é€šè¿‡requestè¯·æ±‚å¾—åˆ°å¯¹åº”çš„html**
+ **JSæ··æ·†**
+ **JSåŠ å¯†ï¼šè¯·æ±‚å‚æ•°åŠ å¯†ä¸”å‚æ•°ä¸å›ºå®š + å“åº”åŠ å¯†**

**-è§£å†³æ–¹æ¡ˆ-ï¼š**

1. *åˆ†ææºä»£ç ï¼Œå‘ç°æ— é™debuggerçš„åŸå› åœ¨äºtxsdefwswå‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°å‰æ‰“ä¸ªæ–­ç‚¹å³å¯*

2. *ç¦ç”¨F12å¼€å‘è€…å·¥å…·,å¯ä»¥ç°åœ¨ç©ºç™½é¡µé¢æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œå†è¿›å…¥è¯¥ç½‘å€ (ç¦ç”¨ctrl+shift+cä¸ç¦ç”¨å³é”®ä¸¤ä¸ªé—®é¢˜è¿˜æœªæœ‰æ•ˆè§£å†³ï¼Œä¸è¿‡æœ‰F12å¼€å‘è€…å·¥å…·çš„è¯å½±å“ä¸å¤§)*

>**JSåŠ¨æ€è¿”å›ã€JSæ··æ·†ã€JSåŠ å¯†è§£å†³æ–¹æ¡ˆ(è¯¦è§[history_data.py](./data/historyDataFetch/history_data.py))ï¼š**

3. *delay_0_y_sï¼šåœ¨0åˆ°random_delay_numç§’ä¹‹é—´å¼•å…¥éšæœºå»¶è¿Ÿã€‚é¿å…é¡µé¢é˜»æ­¢é¢‘ç¹è®¿é—®*
4. *getJSï¼šä»ç½‘ç«™è·å–JavaScriptä»£ç ï¼Œæå–ç›¸å…³ä¿¡æ¯ï¼Œå¹¶æ‰§è¡Œè§£ç æ“ä½œã€‚åŠ¨æ€è§£æJSåŠ è½½çš„å†…å®¹*
5. *getParamesï¼šä½¿ç”¨æå–çš„JavaScriptä»£ç ç”Ÿæˆç”¨äºå‘èµ·APIè¯·æ±‚çš„ç­¾å*
6. *decryptï¼šJSè§£å¯†å‡½æ•°ï¼Œä½¿ç”¨JavaScriptä¸Šä¸‹æ–‡è§£å¯†ä»APIæ¥æ”¶åˆ°çš„æ•°æ®*
7. *getEncryptDataï¼šå‘æŒ‡å®šçš„APIç«¯ç‚¹å‘é€åŒ…å«åŠ å¯†æ•°æ®çš„POSTè¯·æ±‚*


**æ³¨ï¼šJSæ··æ·†ä¸åŠ å¯†çš„è§£å†³ç®—æ³•å‚è€ƒ(https://github.com/xin5683/get_aqi)**

**historyData.pyçˆ¬è™«ä»£ç å‚æ•°åˆ†æï¼š**

>![](./images/8.png)
>*å¯ä»¥é€šè¿‡è°ƒæ•´city_setå’Œyears_monthçš„å†…å®¹æ¥çˆ¬å–ä¸åŒåŸå¸‚ä¸åŒæ—¶é—´æ®µçš„AQIæ•°æ®*

***æ³¨ï¼šåœ¨å®é™…çˆ¬å–è¿‡ç¨‹ä¸­ï¼Œç½‘é¡µä¼šå¯¹IPåœ°å€çš„é¢‘ç¹è®¿é—®è¿›è¡Œé™åˆ¶æˆ–å°ç¦ã€‚é€šè¿‡æ›´æ¢ç½‘ç»œèŠ‚ç‚¹ï¼Œå¯ä»¥é¿å…è¢«å°ç¦ï¼Œç»§ç»­è¿›è¡Œçˆ¬å–ã€‚ä¹Ÿå¯å°†åŒcity_setè®¾ç½®ä¸ºä¸€ä¸ªçœä¼šåŸå¸‚åˆ†å¤šæ¬¡å»çˆ¬å–æ•°æ®ã€‚***

**é¢‘ç¹æ›´æ¢ç½‘ç»œèŠ‚ç‚¹ä¹Ÿå¯èƒ½è¢«è§†ä¸ºæ»¥ç”¨ç½‘ç«™æœåŠ¡ï¼Œè¿åäº†ç½‘ç«™çš„ä½¿ç”¨æ¡æ¬¾ã€‚åœ¨è¿›è¡Œç½‘ç»œçˆ¬è™«æ—¶ï¼Œå»ºè®®å…ˆä»”ç»†é˜…è¯»ç½‘ç«™çš„robots.txtæ–‡ä»¶ï¼Œäº†è§£ç½‘ç«™çš„ä½¿ç”¨æ”¿ç­–ï¼Œå¹¶å°Šé‡ç½‘ç«™çš„è§„å®šã€‚**

******

### â‘¡æ•°æ®çˆ¬å–ç»“æœï¼š

>**å•ä¸ªåŸå¸‚è¿‘åå¹´AQIæ•°æ®ï¼ˆä»¥ä¸Šæµ·å¸‚ä¸ºä¾‹ï¼Œä»2014/01/01-2023/12/31çš„æ•°æ®ï¼‰ï¼š**
>![](./images/9.png)

>**å…¶ä½™åŸå¸‚æ•°æ®ä¿å­˜åœ¨å¯¹åº”çš„csvæ–‡ä»¶ä¸­([çœä¼šåŸå¸‚AQIæ•°æ®](./data/AllData))ï¼š**

>![](./images/10.png)

******


## ï¼ˆ2ï¼‰AQIå®æ—¶æ•°æ®è·å–

### â‘ æ•°æ®çˆ¬å–è¿‡ç¨‹ï¼š

>**ä»ç©ºæ°”è´¨é‡åœ¨çº¿ç›‘æµ‹å¹³å°çˆ¬å–å®æ—¶æ•°æ®(https://www.aqistudy.cn/)**
![](./images/11.png)

******

**è¯¥ç½‘é¡µçš„çˆ¬å–é™åˆ¶äºå†å²æ•°æ®çˆ¬å–ç±»ä¼¼ï¼Œè¿™é‡Œä¸åšçˆ¬è™«åˆ†æï¼Œç›´æ¥ç»™å‡ºç»“æœï¼š**

***è¿è¡Œ[realtime_data.py](./data/realtimeDataFetch/realtime_data.py)ï¼Œåˆ†æçˆ¬å–å†…å®¹ï¼Œæå–ç›®æ ‡å­—æ®µ***
![](./images/12.png)

![](./images/13.png)

### â‘¡å®æ—¶æ•°æ®çˆ¬å–ç»“æœï¼š

> ![](./images/14.png)


***
# ä¸‰ã€æ•°æ®åˆ†æä¸å¯è§†åŒ–

## ï¼ˆä¸€ï¼‰æ•°æ®é¢„å¤„ç†

***

> **å…ˆæ£€æµ‹çˆ¬å–çš„æ•°æ®ä¸­æ˜¯å¦æœ‰ç¼ºå¤±æ•°æ®ï¼Œå¹¶å°†å„çœä¼šåŸå¸‚2014/01/01-2023/12/31æ¯æ—¥AQIç›¸å…³æ•°æ®æ•´åˆæˆå¹´åº¦æ•°æ®([æ€»ç»Ÿè®¡ç»“æœ.csv](./data/dataAnalyse/æ€»ç»Ÿè®¡ç»“æœ.csv))ï¼š**



```python

```



    æ–‡ä»¶ä¸­å­˜åœ¨ç¼ºå¤±æ•°æ®ã€‚
    ç¼ºå¤±æ•°æ®ç»Ÿè®¡ï¼š
    time_point     0
    aqi            0
    pm2_5          0
    pm10           0
    so2            0
    no2            0
    co             0
    o3             0
    rank          30
    quality        0
    å¹´ä»½             0
    dtype: int64
  

**å¯ä»¥çœ‹å‡ºæ¯ä¸ªçœä¼šåŸå¸‚AQIæ•°æ®ä¸­ç¼ºå¤±åªæœ‰rankç´¢å¼•å¯¹åº”çš„æ•°æ®ï¼ˆè¯¥æ•°æ®æ˜¯å„çœä¼šåŸå¸‚æ—¥AQIç­‰çº§çš„å…¨å›½æ’åï¼Œå¯ä»¥é€šè¿‡å„çœä¼šåŸå¸‚æ—¥AQIçš„å€¼é—´æ¥è®¡ç®—å‡ºæ¥ï¼‰**

**ä¹Ÿå°±ç›¸å½“äºAQIæ•°æ®æ˜¯æ— ç¼ºå¤±çš„ï¼Œæ— éœ€å¯¹ç¼ºå¤±æ•°æ®é¡¹é¢å¤–å¤„ç†**
 
> **å„çœä¼šåŸå¸‚AQIå¹´åº¦å†å²æ•°æ®ç‰¹å¾æŸ¥çœ‹ï¼š**

```python
merged_result # å¹´åº¦å†å²æ•°æ®
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>å¹³å‡AQI</th>
      <th>ä¼˜</th>
      <th>è‰¯</th>
      <th>è½»åº¦æ±¡æŸ“</th>
      <th>ä¸­åº¦æ±¡æŸ“</th>
      <th>é‡åº¦æ±¡æŸ“</th>
    </tr>
    <tr>
      <th>åŸå¸‚</th>
      <th>å¹´ä»½</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">ä¸Šæµ·</th>
      <th>2014</th>
      <td>80.457534</td>
      <td>64</td>
      <td>219</td>
      <td>59</td>
      <td>18</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>88.572603</td>
      <td>58</td>
      <td>197</td>
      <td>78</td>
      <td>25</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>80.819672</td>
      <td>72</td>
      <td>201</td>
      <td>73</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>83.630137</td>
      <td>62</td>
      <td>208</td>
      <td>74</td>
      <td>18</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>70.065753</td>
      <td>115</td>
      <td>193</td>
      <td>48</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">é•¿æ²™</th>
      <th>2019</th>
      <td>83.589041</td>
      <td>76</td>
      <td>199</td>
      <td>69</td>
      <td>13</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>70.775956</td>
      <td>123</td>
      <td>187</td>
      <td>47</td>
      <td>9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>75.613699</td>
      <td>95</td>
      <td>209</td>
      <td>47</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>71.391781</td>
      <td>116</td>
      <td>186</td>
      <td>57</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>71.513736</td>
      <td>109</td>
      <td>211</td>
      <td>30</td>
      <td>7</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>310 rows Ã— 6 columns</p>
</div>



> **å„çœä¼šåŸå¸‚å®æ—¶AQIæ•°æ®æŸ¥çœ‹:**


```python
history_data = pd.read_csv('../realtimeDataFetch/realtimeData.csv')
history_data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>City</th>
      <th>Date</th>
      <th>AQI</th>
      <th>weather</th>
      <th>level</th>
      <th>PM2.5</th>
      <th>PM10</th>
      <th>NO2</th>
      <th>CO</th>
      <th>SO2</th>
      <th>O3</th>
      <th>temperature</th>
      <th>humidity</th>
      <th>visibility</th>
      <th>wind</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>åŒ—äº¬</td>
      <td>2024-01-18 16:00:00</td>
      <td>108</td>
      <td>æ™´è½¬å¤šäº‘</td>
      <td>äºŒçº§</td>
      <td>67</td>
      <td>88</td>
      <td>45.0</td>
      <td>0.9</td>
      <td>5.0</td>
      <td>24.375</td>
      <td>2.1</td>
      <td>53</td>
      <td>10</td>
      <td>235.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>å¤©æ´¥</td>
      <td>2024-01-18 16:00:00</td>
      <td>68</td>
      <td>æ™´è½¬å¤šäº‘</td>
      <td>ä¸€çº§</td>
      <td>18</td>
      <td>33</td>
      <td>34.0</td>
      <td>0.8</td>
      <td>11.0</td>
      <td>40.625</td>
      <td>2.9</td>
      <td>46</td>
      <td>10</td>
      <td>170.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ä¸Šæµ·</td>
      <td>2024-01-18 16:00:00</td>
      <td>82</td>
      <td>å°é›¨</td>
      <td>äºŒçº§</td>
      <td>44</td>
      <td>52</td>
      <td>49.0</td>
      <td>1.1</td>
      <td>7.0</td>
      <td>11.500</td>
      <td>8.9</td>
      <td>90</td>
      <td>10</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>é‡åº†</td>
      <td>2024-01-18 16:00:00</td>
      <td>52</td>
      <td>å°é›¨</td>
      <td>ä¸€çº§</td>
      <td>34</td>
      <td>47</td>
      <td>32.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>14.125</td>
      <td>14.2</td>
      <td>76</td>
      <td>10</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>çŸ³å®¶åº„</td>
      <td>2024-01-18 16:00:00</td>
      <td>133</td>
      <td>å¤šäº‘è½¬é˜´</td>
      <td>ä¸‰çº§</td>
      <td>91</td>
      <td>110</td>
      <td>38.0</td>
      <td>0.8</td>
      <td>2.0</td>
      <td>15.000</td>
      <td>1.6</td>
      <td>77</td>
      <td>10</td>
      <td>312.0</td>
    </tr>
  </tbody>
</table>
</div>



***
## ï¼ˆäºŒï¼‰ æ•°æ®å¯è§†åŒ–

 ###   â‘  **Matplotlibåˆæ­¥å¯è§†åŒ–**

> + **2014å¹´è‡³2023å¹´æœŸé—´å„çœä¼šåŸå¸‚å¹´å¹³å‡AQIå˜åŒ–æŠ˜çº¿å›¾ï¼š**

  
![png](images/data_analyse_7_0.png)
    


> + **2014å¹´è‡³2023å¹´çœä¼šåŸå¸‚ç©ºæ°”è´¨é‡ç­‰çº§å¹´å æ¯”å †ç§¯æ¡å½¢å›¾ï¼ˆä»¥ä¸Šæµ·å¸‚ä¸ºä¾‹ï¼‰:**


 
![png](images/data_analyse_9_1.png)
    


###  â‘¡ **APache EChartsæ•°æ®å¯è§†åŒ–**

> **å…¨å›½çœä¼šåŸå¸‚AQIç›‘æµ‹æŸ¥è¯¢å¤§å±ï¼ˆ[app.py](./app.py)ï¼‰ï¼š**

![](./images/å¤§å±é™æ€.png)

<a name="ApacheCharts"></a>

> **å¤§å±å›¾è¡¨åŠ¨å›¾å±•ç¤ºï¼š**

> + **å…¨å›½çœä¼šåŸå¸‚å®æ—¶AQIä¿¡æ¯åœ°å›¾ï¼ˆmapï¼‰**
![](./images/mapAQI.gif)

> + **å…¨å›½çœä¼šåŸå¸‚å¹´AQIåŠ¨æ€æ’åå›¾**
![](./images/chart1.gif)

> + **2014-2023å¹´å…¨å›½çœä¼šåŸå¸‚å¹´å‡AQIå˜åŒ–å›¾**
![](./images/chart2.gif)

> + **å…¨å›½çœä¼šåŸå¸‚å¹´ç©ºæ°”è´¨é‡ç­‰çº§å æ¯”å›¾**
![](./images/chart3.gif)

> + **2014-2023ä¸Šæµ·å¸‚æ—¥AQIå˜åŒ–å›¾è¡¨**
![](./images/chart4.gif)

> + **å¹´å‡ç©ºæ°”è´¨é‡ç­‰çº§çœä¼šåŸå¸‚åˆ†å¸ƒå›¾**
![](./images/chart5.gif)

> + **AQIæ±¡æŸ“ç‰©é›·è¾¾å›¾**
![](./images/chart6.gif)


# å››ã€AQIæ—¶åºé¢„æµ‹æ¨¡å‹æ„å»º

###  **[-æ¨¡å‹æ„å»ºä»£ç -](./predictModel/model.ipynb)**

## ï¼ˆä¸€ï¼‰æ•°æ®æ¸…æ´—ä¸ç‰¹å¾é€‰æ‹©
*******


```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

import warnings
warnings.filterwarnings("ignore")
warnings.simplefilter(action='ignore', category=FutureWarning)

df_main = pd.read_csv("AQI_prediction_dataset.csv")
df_main.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>PM2.5</th>
      <th>PM10</th>
      <th>NO2</th>
      <th>NOx</th>
      <th>CO</th>
      <th>SO2</th>
      <th>O3</th>
      <th>temp</th>
      <th>max_temp</th>
      <th>min_temp</th>
      <th>humid</th>
      <th>visible</th>
      <th>wind</th>
      <th>AQI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01-01-2016</td>
      <td>56.40</td>
      <td>95.08</td>
      <td>51.73</td>
      <td>34.31</td>
      <td>0.69</td>
      <td>7.44</td>
      <td>55.96</td>
      <td>20.1</td>
      <td>28.4</td>
      <td>15.7</td>
      <td>54.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>101</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-01-2016</td>
      <td>53.69</td>
      <td>93.92</td>
      <td>73.09</td>
      <td>54.77</td>
      <td>0.76</td>
      <td>8.67</td>
      <td>34.06</td>
      <td>20.8</td>
      <td>28.3</td>
      <td>12.9</td>
      <td>45.0</td>
      <td>6.3</td>
      <td>1.1</td>
      <td>92</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03-01-2016</td>
      <td>62.35</td>
      <td>99.34</td>
      <td>77.77</td>
      <td>55.60</td>
      <td>0.96</td>
      <td>9.10</td>
      <td>47.62</td>
      <td>21.4</td>
      <td>29.0</td>
      <td>13.7</td>
      <td>45.0</td>
      <td>6.3</td>
      <td>0.4</td>
      <td>108</td>
    </tr>
    <tr>
      <th>3</th>
      <td>04-01-2016</td>
      <td>64.96</td>
      <td>104.62</td>
      <td>77.07</td>
      <td>50.81</td>
      <td>0.89</td>
      <td>8.87</td>
      <td>50.62</td>
      <td>21.5</td>
      <td>29.0</td>
      <td>15.2</td>
      <td>47.0</td>
      <td>6.9</td>
      <td>2.2</td>
      <td>109</td>
    </tr>
    <tr>
      <th>4</th>
      <td>05-01-2016</td>
      <td>70.15</td>
      <td>105.12</td>
      <td>79.43</td>
      <td>56.05</td>
      <td>0.85</td>
      <td>9.41</td>
      <td>36.94</td>
      <td>20.9</td>
      <td>28.4</td>
      <td>14.7</td>
      <td>51.0</td>
      <td>6.3</td>
      <td>1.1</td>
      <td>114</td>
    </tr>
  </tbody>
</table>
</div>




**å°†æ—¥æœŸå­—ç¬¦ä¸²è½¬åŒ–ä¸ºdatetime64[ns]ç±»å‹ï¼Œä½¿å¾—å¯ä»¥æ›´æ–¹ä¾¿åœ°åœ¨åç»­çš„æ—¶é—´åºåˆ—åˆ†æä¸­ä½¿ç”¨ã€‚**


```python
df_main["Date"] = pd.to_datetime(df_main["Date"], format="%d-%m-%Y")
df_main.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1623 entries, 0 to 1622
    Data columns (total 15 columns):
     #   Column    Non-Null Count  Dtype         
    ---  ------    --------------  -----         
     0   Date      1623 non-null   datetime64[ns]
     1   PM2.5     1623 non-null   float64       
     2   PM10      1623 non-null   float64       
     3   NO2       1623 non-null   float64       
     4   NOx       1623 non-null   float64       
     5   CO        1623 non-null   float64       
     6   SO2       1623 non-null   float64       
     7   O3        1623 non-null   float64       
     8   temp      1623 non-null   float64       
     9   max_temp  1623 non-null   float64       
     10  min_temp  1623 non-null   float64       
     11  humid     1623 non-null   float64       
     12  visible   1623 non-null   float64       
     13  wind      1623 non-null   float64       
     14  AQI       1623 non-null   int64         
    dtypes: datetime64[ns](1), float64(13), int64(1)
    memory usage: 190.3 KB
    

***
**çƒ­åŠ›å›¾æŸ¥çœ‹æœ‰æ— æ•°æ®ç¼ºå¤±å€¼**


```python
sns.heatmap(df_main.isnull())
```




    <Axes: >




    
![png](images/model_5_1.png)
 
***
**çƒ­åŠ›å›¾æŸ¥çœ‹AQIä¸å„ç©ºæ°”æ±¡æŸ“ç‰©å…³ç³»**

~~~python
df_main_no_date = df_main.drop('Date', axis=1)
# è®¡ç®—ç›¸å…³æ€§çŸ©é˜µ
correlation_matrix = df_main_no_date.corr()
# ç»˜åˆ¶çƒ­åŠ›å›¾
plt.figure(figsize=(12, 10))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', fmt=".2f")
~~~
![png](images/model_5_0.png)

***
**é€‰æ‹©PM2.5 PM10 NO2	NOx	CO	SO2	O3	temp max_temp min_temp	humid visible wind ä½œä¸ºæ•°æ®ç‰¹å¾**



```python
df_x = df_main.iloc[:, 0:13]  # å‡è®¾å‰13åˆ—æ˜¯ç‰¹å¾
df_y = df_main[['Date', 'AQI']]
df_x.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>PM2.5</th>
      <th>PM10</th>
      <th>NO2</th>
      <th>NOx</th>
      <th>CO</th>
      <th>SO2</th>
      <th>O3</th>
      <th>temp</th>
      <th>max_temp</th>
      <th>min_temp</th>
      <th>humid</th>
      <th>visible</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-01-01</td>
      <td>56.40</td>
      <td>95.08</td>
      <td>51.73</td>
      <td>34.31</td>
      <td>0.69</td>
      <td>7.44</td>
      <td>55.96</td>
      <td>20.1</td>
      <td>28.4</td>
      <td>15.7</td>
      <td>54.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-01-02</td>
      <td>53.69</td>
      <td>93.92</td>
      <td>73.09</td>
      <td>54.77</td>
      <td>0.76</td>
      <td>8.67</td>
      <td>34.06</td>
      <td>20.8</td>
      <td>28.3</td>
      <td>12.9</td>
      <td>45.0</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-01-03</td>
      <td>62.35</td>
      <td>99.34</td>
      <td>77.77</td>
      <td>55.60</td>
      <td>0.96</td>
      <td>9.10</td>
      <td>47.62</td>
      <td>21.4</td>
      <td>29.0</td>
      <td>13.7</td>
      <td>45.0</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-01-04</td>
      <td>64.96</td>
      <td>104.62</td>
      <td>77.07</td>
      <td>50.81</td>
      <td>0.89</td>
      <td>8.87</td>
      <td>50.62</td>
      <td>21.5</td>
      <td>29.0</td>
      <td>15.2</td>
      <td>47.0</td>
      <td>6.9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-01-05</td>
      <td>70.15</td>
      <td>105.12</td>
      <td>79.43</td>
      <td>56.05</td>
      <td>0.85</td>
      <td>9.41</td>
      <td>36.94</td>
      <td>20.9</td>
      <td>28.4</td>
      <td>14.7</td>
      <td>51.0</td>
      <td>6.3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_y.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>AQI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-01-01</td>
      <td>101</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-01-02</td>
      <td>92</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-01-03</td>
      <td>108</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-01-04</td>
      <td>109</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-01-05</td>
      <td>114</td>
    </tr>
  </tbody>
</table>
</div>



***
## ï¼ˆäºŒï¼‰æ¨¡å‹è®­ç»ƒé›†ä¸æµ‹è¯•é›†åˆ’åˆ†
******

**å°†åŸæ•°æ®é›†çš„80%ä½œä¸ºè®­ç»ƒé›†ï¼Œ20%ä½œä¸ºæµ‹è¯•é›†**


```python
# å°†æ•°æ®æ‹†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†
split_index = int(0.8 * len(df_main))  # 80% ç”¨äºè®­ç»ƒï¼Œ20% ç”¨äºæµ‹è¯•

df_x_train = df_x.iloc[:split_index, :]
df_y_train = df_y.iloc[:split_index, :]

df_x_test = df_x.iloc[split_index:, :]
df_y_test = df_y.iloc[split_index:, :]

# å°†æ•°æ®é›†ä¿å­˜ä¸ºCSVæ–‡ä»¶
df_x_train.to_csv("train_x.csv", index=False)
df_y_train.to_csv("train_y.csv", index=False)
df_x_test.to_csv("test_x.csv", index=False)
df_y_test.to_csv("test_y.csv", index=False)

x_train = df_x_train.drop(['Date'], axis = 1)
y_train = df_y_train["AQI"]
x_test = df_x_test.drop(['Date'], axis = 1)
y_test = df_y_test["AQI"]
```

**æ¨¡å‹æ•°æ®æ ‡å‡†åŒ–ä¸å½’ä¸€åŒ–**


```python
from sklearn.preprocessing import StandardScaler, MinMaxScaler

sc_x = StandardScaler()
x_train = sc_x.fit_transform(x_train)
x_test = sc_x.transform(x_test)

sc_y = StandardScaler()
y_train = sc_y.fit_transform(np.array(y_train).reshape(-1,1))
y_test = sc_y.transform(np.array(y_test).reshape(-1,1))
```

**æ ‡å‡†åŒ–åæ•°æ®**


```python
x_train[:5]
```




    array([[ 0.64452375,  0.15265131,  1.53397359,  0.88701906, -0.17785498,
             0.98591707,  1.12788241, -1.8410119 , -0.75386963, -1.74104538,
            -0.54728196, -0.97174871],
           [ 0.54101309,  0.12322334,  3.15079158,  2.18525119, -0.14482841,
             1.51557503, -0.06419501, -1.54318259, -0.78787032, -2.90596254,
            -1.12831053, -0.4973565 ],
           [ 0.87178884,  0.26072297,  3.50503822,  2.23791652, -0.05046676,
             1.70074   ,  0.6739132 , -1.28790033, -0.54986551, -2.57312907,
            -1.12831053, -0.4973565 ],
           [ 0.97147991,  0.39467094,  3.45205261,  1.93398046, -0.08349334,
             1.60169827,  0.83721148, -1.24535329, -0.54986551, -1.9490663 ,
            -0.99919307,  0.45142793],
           [ 1.16971618,  0.40735541,  3.6306898 ,  2.26647002, -0.10236567,
             1.83423103,  0.09257134, -1.50063555, -0.75386963, -2.15708722,
            -0.74095815, -0.4973565 ]])




```python
y_train[:5]
```




    array([[ 0.17883525],
           [-0.04953744],
           [ 0.35645846],
           [ 0.3818332 ],
           [ 0.50870692]])



***
## ï¼ˆä¸‰ï¼‰é¢„æµ‹æ¨¡å‹é€‰æ‹©ä¸è®­ç»ƒ
***

> ### â‘ å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹(MLR)


```python
from sklearn.linear_model import LinearRegression
regressor = LinearRegression()
regressor.fit(x_train,y_train)
```



***
> **MLRæ¨¡å‹é¢„æµ‹ç»“æœ**



```python
y_prediction =  regressor.predict(x_test)
y_test_stand = y_test
y_prediction_stand = y_prediction
y_test = sc_y.inverse_transform(y_test)
y_prediction = sc_y.inverse_transform(y_prediction)

result = pd.DataFrame()
result["ACTUAL AQI"] = y_test.flatten()
result["PREDICTED AQI"] = y_prediction
result["DIFFERENCE"] = result["ACTUAL AQI"] - result["PREDICTED AQI"]
result["PERCENTAGE ERROR"] = ( abs(result["ACTUAL AQI"] - result["PREDICTED AQI"] ) / result["ACTUAL AQI"] ) * 100
result.head(15)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ACTUAL AQI</th>
      <th>PREDICTED AQI</th>
      <th>DIFFERENCE</th>
      <th>PERCENTAGE ERROR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50.0</td>
      <td>52.405428</td>
      <td>-2.405428</td>
      <td>4.810856</td>
    </tr>
    <tr>
      <th>1</th>
      <td>52.0</td>
      <td>63.171489</td>
      <td>-11.171489</td>
      <td>21.483633</td>
    </tr>
    <tr>
      <th>2</th>
      <td>68.0</td>
      <td>64.378722</td>
      <td>3.621278</td>
      <td>5.325409</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70.0</td>
      <td>64.132717</td>
      <td>5.867283</td>
      <td>8.381833</td>
    </tr>
    <tr>
      <th>4</th>
      <td>59.0</td>
      <td>55.349071</td>
      <td>3.650929</td>
      <td>6.188015</td>
    </tr>
    <tr>
      <th>5</th>
      <td>51.0</td>
      <td>53.608991</td>
      <td>-2.608991</td>
      <td>5.115669</td>
    </tr>
    <tr>
      <th>6</th>
      <td>61.0</td>
      <td>65.889212</td>
      <td>-4.889212</td>
      <td>8.015101</td>
    </tr>
    <tr>
      <th>7</th>
      <td>67.0</td>
      <td>66.766868</td>
      <td>0.233132</td>
      <td>0.347959</td>
    </tr>
    <tr>
      <th>8</th>
      <td>65.0</td>
      <td>65.194460</td>
      <td>-0.194460</td>
      <td>0.299169</td>
    </tr>
    <tr>
      <th>9</th>
      <td>74.0</td>
      <td>62.123186</td>
      <td>11.876814</td>
      <td>16.049748</td>
    </tr>
    <tr>
      <th>10</th>
      <td>73.0</td>
      <td>59.544241</td>
      <td>13.455759</td>
      <td>18.432547</td>
    </tr>
    <tr>
      <th>11</th>
      <td>68.0</td>
      <td>64.356281</td>
      <td>3.643719</td>
      <td>5.358410</td>
    </tr>
    <tr>
      <th>12</th>
      <td>65.0</td>
      <td>56.782363</td>
      <td>8.217637</td>
      <td>12.642519</td>
    </tr>
    <tr>
      <th>13</th>
      <td>57.0</td>
      <td>66.250745</td>
      <td>-9.250745</td>
      <td>16.229377</td>
    </tr>
    <tr>
      <th>14</th>
      <td>68.0</td>
      <td>59.379263</td>
      <td>8.620737</td>
      <td>12.677555</td>
    </tr>
  </tbody>
</table>
</div>



***
> **MLRæ¨¡å‹è¯„ä»·**


```python
from sklearn.metrics import r2_score
from sklearn.metrics import mean_squared_error
from sklearn.metrics import mean_absolute_error
score = r2_score(y_test_stand,y_prediction_stand)
mean_error = mean_squared_error(y_test_stand,y_prediction_stand)
mae = mean_absolute_error(y_test_stand,y_prediction_stand)
print("R2 SCOREï¼ˆå†³å®šç³»æ•°ï¼‰:", score)
print("mean_sqrd_errorï¼ˆå‡æ–¹è¯¯å·®ï¼‰: ", mean_error)
print("Root mean squared errorï¼ˆå‡æ–¹æ ¹è¯¯å·®ï¼‰:",np.sqrt(mean_error))
print("Mean Absolute errorï¼ˆå¹³å‡ç»å¯¹è¯¯å·®ï¼‰ï¼š", mae)
```

    R2 SCOREï¼ˆå†³å®šç³»æ•°ï¼‰: 0.8158947552296449
    mean_sqrd_errorï¼ˆå‡æ–¹è¯¯å·®ï¼‰:  0.047328897674621444
    Root mean squared errorï¼ˆå‡æ–¹æ ¹è¯¯å·®ï¼‰: 0.21755205738999905
    Mean Absolute errorï¼ˆå¹³å‡ç»å¯¹è¯¯å·®ï¼‰ï¼š 0.16482457853456733
    

> **å†³å®šç³»æ•° ä¸º 0.8159ï¼Œè¡¨æ˜æ¨¡å‹ç›¸å¯¹è¾ƒå¥½åœ°è§£é‡Šäº†ç›®æ ‡å˜é‡çš„æ–¹å·®ã€‚**

> **å‡æ–¹è¯¯å·®ä¸º 0.0473ï¼Œè¡¨ç¤ºæ¨¡å‹çš„é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å¹³æ–¹å·®ç›¸å¯¹è¾ƒå°ã€‚**

> **å‡æ–¹æ ¹è¯¯å·®ä¸º 0.2176ï¼Œè¡¨ç¤ºæ¨¡å‹çš„é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å¹³å‡è·ç¦»ç›¸å¯¹è¾ƒå°ã€‚**

> **å¹³å‡ç»å¯¹è¯¯å·®ä¸º 0.1648ï¼Œè¡¨ç¤ºæ¨¡å‹çš„å¹³å‡é¢„æµ‹è¯¯å·®ç›¸å¯¹è¾ƒå°ã€‚**

> **æ€»ä½“è€Œè¨€ï¼Œæ¨¡å‹åœ¨æä¾›çš„è¯„ä¼°æŒ‡æ ‡ä¸‹è¡¨ç°è‰¯å¥½ã€‚**

***
> **MLRæ¨¡å‹ç»“æœæ›²çº¿**



```python
df1 = pd.DataFrame({'Actual': y_test[50:150].flatten(), 'Predicted': y_prediction[50:150].flatten()})
df1.plot(kind='line')
plt.grid(which='major', linestyle='-', linewidth='0.5', color='green')
plt.grid(which='minor', linestyle=':', linewidth='0.5', color='black')
plt.show()
```


    
![png](images/model_26_0.png)
    


**ä»æ¨¡å‹é¢„æµ‹ç»“æœå¯ä»¥å‘ç°ï¼Œå¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹åœ¨AQIçš„æ—¶åºé¢„æµ‹ä¸Šæœ‰è¾ƒå¥½çš„è¡¨ç°**

***
> ### â‘¡éšæœºæ£®æ—æ¨¡å‹(RF)

**æ•°æ®å¤„ç†ä¸ç‰¹å¾é€‰æ‹©ä¸MLRç±»ä¼¼ï¼Œè¿™é‡Œä¸å†èµ˜è¿°**

>**RFæ¨¡å‹è®­ç»ƒ:**


```python
from sklearn.feature_selection import SelectKBest
from sklearn.feature_selection import mutual_info_regression

fs = SelectKBest(score_func=mutual_info_regression, k='all')
fs.fit(x_train, y_train)
x_train_fs = fs.transform(x_train)
x_test_fs = fs.transform(x_test)

from sklearn.ensemble import RandomForestRegressor
regressor = RandomForestRegressor()
regressor.fit(x_train_fs,y_train)
```




***
>**RFæ¨¡å‹ç»“æœ:**


```python
y_prediction =  regressor.predict(x_test_fs)

from sklearn.metrics import r2_score
from sklearn.metrics import mean_squared_error
from sklearn.metrics import mean_absolute_error
score = r2_score(y_test_stand,y_prediction)
mean_error = mean_squared_error(y_test_stand,y_prediction)
mae = mean_absolute_error(y_test_stand,y_prediction)
print("R2 SCOREï¼ˆå†³å®šç³»æ•°ï¼‰:", score)
print("mean_sqrd_errorï¼ˆå‡æ–¹è¯¯å·®ï¼‰: ", mean_error)
print("Root mean squared errorï¼ˆå‡æ–¹æ ¹è¯¯å·®ï¼‰:",np.sqrt(mean_error))
print("Mean Absolute errorï¼ˆå¹³å‡ç»å¯¹è¯¯å·®ï¼‰ï¼š", mae)
```

    R2 SCOREï¼ˆå†³å®šç³»æ•°ï¼‰: 0.8108518920185419
    mean_sqrd_errorï¼ˆå‡æ–¹è¯¯å·®ï¼‰:  0.04862529288162989
    Root mean squared errorï¼ˆå‡æ–¹æ ¹è¯¯å·®ï¼‰: 0.22051143480924043
    Mean Absolute errorï¼ˆå¹³å‡ç»å¯¹è¯¯å·®ï¼‰ï¼š 0.1711327370227373
    

> **å†³å®šç³»æ•° ä¸º 0.8109ï¼Œè¡¨æ˜æ¨¡å‹ç›¸å¯¹è¾ƒå¥½åœ°è§£é‡Šäº†ç›®æ ‡å˜é‡çš„æ–¹å·®ã€‚**

> **å‡æ–¹è¯¯å·®ä¸º 0.04863ï¼Œè¡¨ç¤ºæ¨¡å‹çš„é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å¹³æ–¹å·®ç›¸å¯¹è¾ƒå°ã€‚**

> **å‡æ–¹æ ¹è¯¯å·®ä¸º 0.2205ï¼Œè¡¨ç¤ºæ¨¡å‹çš„é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å¹³å‡è·ç¦»ç›¸å¯¹è¾ƒå°ã€‚**

> **å¹³å‡ç»å¯¹è¯¯å·®ä¸º 0.1711ï¼Œè¡¨ç¤ºæ¨¡å‹çš„å¹³å‡é¢„æµ‹è¯¯å·®ç›¸å¯¹è¾ƒå°ã€‚**

> **æ€»ä½“è€Œè¨€ï¼Œæ¨¡å‹åœ¨æä¾›çš„è¯„ä¼°æŒ‡æ ‡ä¸‹è¡¨ç°è‰¯å¥½ã€‚**


```python
y_prediction = y_prediction.reshape(-1, 1)
y_prediction = sc_y.inverse_transform(y_prediction)

result = pd.DataFrame()
result["ACTUAL AQI"] = y_test.flatten()
result["PREDICTED AQI"] = y_prediction
result["DIFFERENCE"] = result["ACTUAL AQI"] - result["PREDICTED AQI"]
result["PERCENTAGE ERROR"] = ( abs(result["ACTUAL AQI"] - result["PREDICTED AQI"] ) / result["ACTUAL AQI"] ) * 100
result.head(15)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ACTUAL AQI</th>
      <th>PREDICTED AQI</th>
      <th>DIFFERENCE</th>
      <th>PERCENTAGE ERROR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50.0</td>
      <td>52.13</td>
      <td>-2.13</td>
      <td>4.260000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>52.0</td>
      <td>59.96</td>
      <td>-7.96</td>
      <td>15.307692</td>
    </tr>
    <tr>
      <th>2</th>
      <td>68.0</td>
      <td>66.96</td>
      <td>1.04</td>
      <td>1.529412</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70.0</td>
      <td>62.65</td>
      <td>7.35</td>
      <td>10.500000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>59.0</td>
      <td>55.59</td>
      <td>3.41</td>
      <td>5.779661</td>
    </tr>
    <tr>
      <th>5</th>
      <td>51.0</td>
      <td>57.27</td>
      <td>-6.27</td>
      <td>12.294118</td>
    </tr>
    <tr>
      <th>6</th>
      <td>61.0</td>
      <td>66.24</td>
      <td>-5.24</td>
      <td>8.590164</td>
    </tr>
    <tr>
      <th>7</th>
      <td>67.0</td>
      <td>67.26</td>
      <td>-0.26</td>
      <td>0.388060</td>
    </tr>
    <tr>
      <th>8</th>
      <td>65.0</td>
      <td>66.77</td>
      <td>-1.77</td>
      <td>2.723077</td>
    </tr>
    <tr>
      <th>9</th>
      <td>74.0</td>
      <td>64.78</td>
      <td>9.22</td>
      <td>12.459459</td>
    </tr>
    <tr>
      <th>10</th>
      <td>73.0</td>
      <td>64.95</td>
      <td>8.05</td>
      <td>11.027397</td>
    </tr>
    <tr>
      <th>11</th>
      <td>68.0</td>
      <td>61.13</td>
      <td>6.87</td>
      <td>10.102941</td>
    </tr>
    <tr>
      <th>12</th>
      <td>65.0</td>
      <td>56.42</td>
      <td>8.58</td>
      <td>13.200000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>57.0</td>
      <td>61.82</td>
      <td>-4.82</td>
      <td>8.456140</td>
    </tr>
    <tr>
      <th>14</th>
      <td>68.0</td>
      <td>56.81</td>
      <td>11.19</td>
      <td>16.455882</td>
    </tr>
  </tbody>
</table>
</div>



>**RFæ¨¡å‹ç»“æœæ›²çº¿**


```python
df1 = pd.DataFrame({'Actual': y_test[50:150].flatten(), 'Predicted': y_prediction[50:150].flatten()})
df1.plot(kind='line')
plt.grid(which='major', linestyle='-', linewidth='0.5', color='green')
plt.grid(which='minor', linestyle=':', linewidth='0.5', color='black')
plt.show()
```


    
![png](images/model_36_0.png)
    


***
> ### â‘¢æ”¯æŒå‘é‡æœºæ¨¡å‹æ¨¡å‹(SVR)

> **SVRæ¨¡å‹è®­ç»ƒ:**


```python
from sklearn.svm import SVR
regressor = SVR(kernel = 'rbf')
regressor.fit(x_train,y_train)
```


> **SVRæ¨¡å‹ç»“æœï¼š**


```python
y_prediction =  regressor.predict(x_test)

score = r2_score(y_test_stand,y_prediction)
mean_error = mean_squared_error(y_test_stand,y_prediction)
mae = mean_absolute_error(y_test_stand,y_prediction)

print("R2 SCOREï¼ˆå†³å®šç³»æ•°ï¼‰:", score)
print("mean_sqrd_errorï¼ˆå‡æ–¹è¯¯å·®ï¼‰: ", mean_error)
print("Root mean squared errorï¼ˆå‡æ–¹æ ¹è¯¯å·®ï¼‰:",np.sqrt(mean_error))
print("Mean Absolute errorï¼ˆå¹³å‡ç»å¯¹è¯¯å·®ï¼‰ï¼š", mae)
```

    R2 SCOREï¼ˆå†³å®šç³»æ•°ï¼‰: 0.8092195175632143
    mean_sqrd_errorï¼ˆå‡æ–¹è¯¯å·®ï¼‰:  0.049044935916021624
    Root mean squared errorï¼ˆå‡æ–¹æ ¹è¯¯å·®ï¼‰: 0.2214609128402157
    Mean Absolute errorï¼ˆå¹³å‡ç»å¯¹è¯¯å·®ï¼‰ï¼š 0.16518709539127896
    

> **å†³å®šç³»æ•° ä¸º 0.8109ï¼Œè¡¨æ˜æ¨¡å‹ç›¸å¯¹è¾ƒå¥½åœ°è§£é‡Šäº†ç›®æ ‡å˜é‡çš„æ–¹å·®ã€‚**

> **å‡æ–¹è¯¯å·®ä¸º 0.04904ï¼Œè¡¨ç¤ºæ¨¡å‹çš„é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å¹³æ–¹å·®ç›¸å¯¹è¾ƒå°ã€‚**

> **å‡æ–¹æ ¹è¯¯å·®ä¸º 0.2215ï¼Œè¡¨ç¤ºæ¨¡å‹çš„é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å¹³å‡è·ç¦»ç›¸å¯¹è¾ƒå°ã€‚**

> **å¹³å‡ç»å¯¹è¯¯å·®ä¸º 0.1652ï¼Œè¡¨ç¤ºæ¨¡å‹çš„å¹³å‡é¢„æµ‹è¯¯å·®ç›¸å¯¹è¾ƒå°ã€‚**

> **æ€»ä½“è€Œè¨€ï¼Œæ¨¡å‹åœ¨æä¾›çš„è¯„ä¼°æŒ‡æ ‡ä¸‹è¡¨ç°è‰¯å¥½ã€‚**


```python
y_prediction = y_prediction.reshape(-1, 1)
y_prediction = sc_y.inverse_transform(y_prediction)

result = pd.DataFrame()
result["ACTUAL AQI"] = y_test.flatten()
result["PREDICTED AQI"] = y_prediction
result["DIFFERENCE"] = result["ACTUAL AQI"] - result["PREDICTED AQI"]
result["PERCENTAGE ERROR"] = ( abs(result["ACTUAL AQI"] - result["PREDICTED AQI"] ) / result["ACTUAL AQI"] ) * 100
result.head(15)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ACTUAL AQI</th>
      <th>PREDICTED AQI</th>
      <th>DIFFERENCE</th>
      <th>PERCENTAGE ERROR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50.0</td>
      <td>48.104838</td>
      <td>1.895162</td>
      <td>3.790325</td>
    </tr>
    <tr>
      <th>1</th>
      <td>52.0</td>
      <td>58.621436</td>
      <td>-6.621436</td>
      <td>12.733530</td>
    </tr>
    <tr>
      <th>2</th>
      <td>68.0</td>
      <td>65.560760</td>
      <td>2.439240</td>
      <td>3.587117</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70.0</td>
      <td>64.976696</td>
      <td>5.023304</td>
      <td>7.176149</td>
    </tr>
    <tr>
      <th>4</th>
      <td>59.0</td>
      <td>52.270687</td>
      <td>6.729313</td>
      <td>11.405615</td>
    </tr>
    <tr>
      <th>5</th>
      <td>51.0</td>
      <td>54.549033</td>
      <td>-3.549033</td>
      <td>6.958888</td>
    </tr>
    <tr>
      <th>6</th>
      <td>61.0</td>
      <td>65.008288</td>
      <td>-4.008288</td>
      <td>6.570964</td>
    </tr>
    <tr>
      <th>7</th>
      <td>67.0</td>
      <td>64.841925</td>
      <td>2.158075</td>
      <td>3.221008</td>
    </tr>
    <tr>
      <th>8</th>
      <td>65.0</td>
      <td>65.225668</td>
      <td>-0.225668</td>
      <td>0.347182</td>
    </tr>
    <tr>
      <th>9</th>
      <td>74.0</td>
      <td>64.694543</td>
      <td>9.305457</td>
      <td>12.574942</td>
    </tr>
    <tr>
      <th>10</th>
      <td>73.0</td>
      <td>63.432002</td>
      <td>9.567998</td>
      <td>13.106847</td>
    </tr>
    <tr>
      <th>11</th>
      <td>68.0</td>
      <td>58.955901</td>
      <td>9.044099</td>
      <td>13.300146</td>
    </tr>
    <tr>
      <th>12</th>
      <td>65.0</td>
      <td>55.900041</td>
      <td>9.099959</td>
      <td>13.999937</td>
    </tr>
    <tr>
      <th>13</th>
      <td>57.0</td>
      <td>58.467728</td>
      <td>-1.467728</td>
      <td>2.574961</td>
    </tr>
    <tr>
      <th>14</th>
      <td>68.0</td>
      <td>51.283295</td>
      <td>16.716705</td>
      <td>24.583389</td>
    </tr>
  </tbody>
</table>
</div>



> **SVRæ¨¡å‹æ›²çº¿**


```python
df1 = pd.DataFrame({'Actual': y_test[50:150].flatten(), 'Predicted': y_prediction[50:150].flatten()})
df1.plot(kind='line')
plt.grid(which='major', linestyle='-', linewidth='0.5', color='green')
plt.grid(which='minor', linestyle=':', linewidth='0.5', color='black')
plt.show()
```


    
![png](images/model_44_0.png)
    


### é¢„æµ‹æ¨¡å‹æ€»ç»“
> + **ä»ä¸‰ç§æ¨¡å‹æ›²çº¿çš„æ‹Ÿåˆç¨‹åº¦ä¸Šæ¥çœ‹ï¼Œä¸‰ç§æ¨¡å‹éƒ½æœ‰è¾ƒå¥½çš„è¡¨ç°ï¼Œè¯´æ˜é€šè¿‡æ—¶é—´åºåˆ—æ¥é¢„æµ‹AQIæ˜¯ç§‘å­¦çš„ã€‚**
>+ **ä»ä¸‰ç§æ¨¡å‹çš„å†³å®šç³»æ•°ã€å‡æ–¹è¯¯å·®ã€å‡æ–¹æ ¹è¯¯å·®ã€å¹³å‡ç»å¯¹è¯¯å·®æŒ‡æ ‡æ¥çœ‹ï¼Œè¿™ä¸‰ç§æ¨¡å‹åœ¨ç»™å®šçš„ä»»åŠ¡ä¸­è¡¨ç°ç›¸å½“ï¼Œå¹¶ä¸”æ²¡æœ‰æ˜æ˜¾çš„ä¼˜åŠ£ä¹‹åˆ†ã€‚é€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹å¯èƒ½éœ€è¦è€ƒè™‘å…·ä½“çš„åº”ç”¨åœºæ™¯ã€æ¨¡å‹çš„è§£é‡Šæ€§ä»¥åŠå…¶ä»–å› ç´ ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå»ºè®®è¿›è¡Œè¿›ä¸€æ­¥çš„äº¤å‰éªŒè¯å’Œæ¨¡å‹è°ƒä¼˜ï¼Œä»¥ç¡®ä¿æ¨¡å‹åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„æ€§èƒ½ç¨³å®šã€‚**



```python

```

# äº”ã€é¡¹ç›®æ€»ç»“

### é¡¹ç›®åˆ†æç»“æœï¼š
+ **æ•´ä½“è¶‹åŠ¿ï¼š2014å¹´åˆ°2023å¹´å„çœä¼šåŸå¸‚AQIå‘ˆç°ä¸‹é™è¶‹åŠ¿ï¼Œè¿™ä¸è¿‘äº›å¹´å›½å®¶å¤§åŠ›æ¨å´‡çš„ç¯å¢ƒä¿æŠ¤æ”¿ç­–å¯†ä¸å¯åˆ†** 
+ **2014-2023åå¹´å†…å¹³å‡AQIæœ€ä½äº”å¤§çœä¼šåŸå¸‚ï¼šæµ·å£: 43.0, è´µé˜³: 52.6, æ˜†æ˜: 52.8, ç¦å·': 54.7, å—å®: 56.9**
+ **2014-2023åå¹´å†…å¹³å‡AQIæœ€é«˜äº”å¤§çœä¼šåŸå¸‚ï¼šå¤ªåŸ': 100.0, è¥¿å®‰: 103.5, æµå—': 107.1, éƒ‘å·: 107.5, çŸ³å®¶åº„: 117.2**
+ **AQIä¸åœ°åŒºå…³ç³»ï¼šåŒ—éƒ¨å†…é™†åœ°åŒºå’Œè¥¿åŒ—éƒ¨åœ°åŒºçš„ç©ºæ°”è´¨é‡è¾ƒå·®ï¼š ä¸­å›½çš„åŒ—éƒ¨å†…é™†åœ°åŒºä»¥åŠè¥¿åŒ—éƒ¨åœ°åŒºçš„ç©ºæ°”è´¨é‡ç›¸å¯¹è¾ƒå·®ï¼Œå¯èƒ½å—åˆ°å·¥ä¸šæ±¡æŸ“ç­‰å› ç´ çš„å½±å“ã€‚æ²¿æµ·åœ°åŒºå’Œé«˜åŸåœ°åŒºçš„ç©ºæ°”è´¨é‡è¾ƒå¥½ï¼š æ²¿æµ·åœ°åŒºå’Œé«˜åŸåœ°åŒºçš„ç©ºæ°”è´¨é‡ç›¸å¯¹è¾ƒå¥½ï¼Œå¯èƒ½å—åˆ°åœ°ç†ç¯å¢ƒå’Œæ°”å€™ç­‰å› ç´ çš„å½±å“ã€‚**
+ **ä¸»è¦æ±¡æŸ“ç‰©åˆ†æï¼š ç©ºæ°”è´¨é‡æœ€å·®çœä»½çš„ä¸»è¦æ±¡æŸ“ç‰©æ˜¯pm10ã€so2ã€no2ã€‚åœ¨ç©ºæ°”è´¨é‡æœ€å·®åŸå¸‚ï¼Œä¸»è¦æ±¡æŸ“ç‰©åŒ…æ‹¬pm2.5ã€pm10ã€so2ã€no2ã€‚so2ä¸no2ä¹‹é—´ã€pm2.5ä¸pm10ã€so2ã€no2ä¹‹é—´æœ‰è¾ƒå¼ºçš„æ­£ç›¸å…³å…³ç³»**
+ **AQIä¸å­£èŠ‚å…³ç³»ï¼š å…¨å›½ç©ºæ°”è´¨é‡å†¬å­£æ—¶æœ€å·®ï¼Œå¹³å‡AQIä¸º91.6ï¼ˆè‰¯å¥½ï¼‰ï¼Œå¤å­£æ—¶æœ€å¥½ï¼Œå¹³å‡AQIä¸º67.9ï¼ˆè‰¯å¥½ï¼‰**

### é¡¹ç›®ä¸è¶³ä¸å€¼å¾—æ”¹è¿›çš„åœ°æ–¹ï¼š

+ **æ•°æ®è€ƒè™‘ä¸å¤Ÿå……åˆ†ï¼šæœªè€ƒè™‘æ¯ä¸ªåŸå¸‚çš„ç‰¹æ®Šå› ç´ ï¼Œå¦‚å·¥ä¸šç»“æ„ã€äº¤é€šçŠ¶å†µã€äººå£å¯†åº¦ç­‰ï¼Œè¿™äº›æŒ‡æ ‡ä¸AQIæœ‰ç€å¯†åˆ‡è”ç³»ã€‚**
+ **é¢„æµ‹æ¨¡å‹ä¸å¤Ÿå‡†ç¡®ï¼šå—é™äºæ•°æ®çš„è·å–ä¸æ¨¡å‹çš„é€‰æ‹©ï¼ŒAQIçš„æ—¶åºé¢„æµ‹æ¨¡å‹å­˜åœ¨ä¸€å®šçš„é™åˆ¶**
+ **å¯æ”¹è¿›åœ°æ–¹ï¼šè·å–æ›´å¤šåŸå¸‚çš„æ•°æ®ä»¥åŠå…¶å®ƒä¸AQIå¯†åˆ‡ç›¸å…³çš„æ•°æ®ï¼ˆå¦‚åŸå¸‚äººå£å¯†åº¦ï¼ŒåŸå¸‚ç»çº¬åº¦ï¼ŒåŸå¸‚æ°”å€™ç­‰ï¼‰ä»¥æ”¹å–„æ•°æ®å¯è§†åŒ–ç¨‹åº¦çš„ä¸é¢„æµ‹æ¨¡å‹çš„å‡†ç¡®æ€§**
